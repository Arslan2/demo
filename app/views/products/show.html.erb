<div class="row">
  <div class="col-md-6">
    <h1><%= @product.title %></h1>
  </div>
  <div class="col-md-2 top">
    <%= link_to 'Add to cart', cart_add_path, id: "add-#{@product.id}", data: { remote: true, params: { product_id: @product.id }.to_param }, class: 'btn btn-warning btn-sm' unless in_cart?(@product) %>
  </div>
</div>

<b>Product Owner</b>
<%= link_to display_name(@product.user), user_path(@product.user) %>

<div>
  <b>Description:</b>
  <%= @product.body %>
</div>

<div>
  <b>Price: $</b>
  <%= @product.price %>
</div>

<% if @product.attachments.present? %>
  <% @product.attachments.each do |attachment| %>
    <div>
      <%= image_tag fetch_image(attachment) %>
    </div>
  <% end %>
<% else %>
  <%= image_tag fetch_image(@product.attachments.first) %>
<% end %>

<h1>Reviews</h1>
<ul id ="show-reviews">
  <% @reviews.each do |review| %>
    <strong><%= link_to display_name(review.user), user_path(review.user) %> says</strong>
    <%= render 'reviews/full_review', review: review %>
    <% if owner?(@product.user_id) %>
      <div>
        <%= link_to product_review_path(@product, review), method: :delete, data: { confirm: 'Are you sure?' } do %>
          <%= image_tag "cross.png", alt: "Delete" %>
        <% end %>
      </div>
    <% end %>
  <% end %>
</ul>

<% if owner?(@product.user_id) %>
  <%= link_to 'Edit', edit_product_path(@product), class: "btn btn-warning" %>
<% else %>
  <%= render 'reviews/ajax_form' if current_user.present? %>
<% end %>
<%= link_to 'Back', products_path %>
